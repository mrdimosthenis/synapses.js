<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Home</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Home</h1>

    



    


    <h3> </h3>










    




    <section>
        <article><h1>synapses.js</h1>
<p>A <strong>neural networks</strong> library for <strong>JavaScript</strong>!</p>
<h2>Basic usage</h2>
<h3>Install synapses-java</h3>
<pre class="prettyprint source"><code>npm i synapses@8.0.0
</code></pre>
<h3>Require the library</h3>
<pre class="prettyprint source lang-javascript"><code>const syn = require('synapses');
</code></pre>
<h3>Create a random neural network by providing its layer sizes</h3>
<pre class="prettyprint source lang-javascript"><code>let randNet = new syn.Net({layers: [2, 3, 1]});
</code></pre>
<ul>
<li>Input layer: the first layer of the network has 2 nodes.</li>
<li>Hidden layer: the second layer has 3 neurons.</li>
<li>Output layer: the third layer has 1 neuron.</li>
</ul>
<h3>Get the json of the random neural network</h3>
<pre class="prettyprint source lang-javascript"><code>randNet.json();
// &quot;[[{\&quot;activationF\&quot; : \&quot;sigmoid\&quot;, \&quot;weights\&quot; : [-0.5,0.1,0.8]}&quot; +
// &quot; ,{\&quot;activationF\&quot; : \&quot;sigmoid\&quot;, \&quot;weights\&quot; : [0.7,0.6,-0.1]},&quot; +
// &quot;  {\&quot;activationF\&quot; : \&quot;sigmoid\&quot;, \&quot;weights\&quot; : [-0.8,-0.1,-0.7]}],&quot; +
// &quot;[{\&quot;activationF\&quot; : \&quot;sigmoid\&quot;, \&quot;weights\&quot; : [0.5,-0.3,-0.4,-0.5]}]]&quot;
</code></pre>
<h3>Create a neural network by providing its json</h3>
<pre class="prettyprint source lang-javascript"><code>let net = new syn.Net({
    json:
        &quot;[[{\&quot;activationF\&quot; : \&quot;sigmoid\&quot;, \&quot;weights\&quot; : [-0.5,0.1,0.8]}&quot; +
        &quot; ,{\&quot;activationF\&quot; : \&quot;sigmoid\&quot;, \&quot;weights\&quot; : [0.7,0.6,-0.1]},&quot; +
        &quot;  {\&quot;activationF\&quot; : \&quot;sigmoid\&quot;, \&quot;weights\&quot; : [-0.8,-0.1,-0.7]}],&quot; +
        &quot; [{\&quot;activationF\&quot; : \&quot;sigmoid\&quot;, \&quot;weights\&quot; : [0.5,-0.3,-0.4,-0.5]}]]&quot;
});
</code></pre>
<h3>Make a prediction</h3>
<pre class="prettyprint source lang-javascript"><code>net.predict([0.2, 0.6]);
// [ 0.49131100324012494 ]
</code></pre>
<h3>Train a neural network</h3>
<pre class="prettyprint source lang-javascript"><code>net.fit(0.1, [0.2, 0.6], [0.9]);
</code></pre>
<p>The <code>fit</code> method adjusts the weights of the neural network to a single observation.</p>
<p>In practice, for a neural network to be fully trained, it should be fitted with multiple observations.</p>
<h2>Advanced usage</h2>
<h3>Create a neural network for testing</h3>
<pre class="prettyprint source lang-javascript"><code>new syn.Net({layers: [2, 3, 1], seed: 1000});
</code></pre>
<p>We can provide a <code>seed</code> to create a non-random neural network.
This way, we can use it for testing.</p>
<h3>Define the activation functions and the weights</h3>
<pre class="prettyprint source lang-javascript"><code>function activation(layerIndex) {
    switch (layerIndex) {
        case 0:
            return syn.fun.SIGMOID;
        case 1:
            return syn.fun.IDENTITY;
        case 2:
            return syn.fun.LEAKY_RE_LU;
        case 3:
            return syn.fun.TANH;
    }
}

function weight(_layerIndex) {
    return 1.0 - 2.0 * Math.random();
}

let customNet = new syn.Net({
    layers: [4, 6, 8, 5, 3],
    activation: activation,
    weight: weight
});
</code></pre>
<ul>
<li>The <code>activation</code> function accepts the index of a layer and returns an activation function for its neurons.</li>
<li>The <code>weight</code> function accepts the index of a layer and returns a weight for the synapses of its neurons.</li>
</ul>
<p>If we don't provide these functions, the activation function of all neurons is sigmoid,
and the weight distribution of the synapses is normal between -1.0 and 1.0.</p>
<h3>Draw a neural network</h3>
<pre class="prettyprint source lang-javascript"><code>customNet.svg();
</code></pre>
<p><img src="https://github.com/mrdimosthenis/synapses.js/blob/master/neural_network.png?raw=true" alt="Network Drawing"></p>
<p>With its svg drawing, we can see what a neural network looks like.
The color of each neuron depends on its activation function
while the transparency of the synapses depends on their weight.</p>
<h3>Measure the difference between the expected and predicted values</h3>
<pre class="prettyprint source lang-javascript"><code>let expAndPredVals = [
    [[0.0, 0.0, 1.0], [0.0, 0.1, 0.9]],
    [[0.0, 1.0, 0.0], [0.8, 0.2, 0.0]],
    [[1.0, 0.0, 0.0], [0.7, 0.1, 0.2]],
    [[1.0, 0.0, 0.0], [0.3, 0.3, 0.4]],
    [[0.0, 0.0, 1.0], [0.2, 0.2, 0.6]]
];
</code></pre>
<ul>
<li>Root-mean-square error</li>
</ul>
<pre class="prettyprint source lang-javascript"><code>syn.stats.rmse(expAndPredVals);
// 0.6957010852370435
</code></pre>
<ul>
<li>Classification accuracy score</li>
</ul>
<pre class="prettyprint source lang-javascript"><code>syn.stats.score(expAndPredVals);
// 0.6
</code></pre>
<h3>Create a <code>Codec</code> by providing the attributes and the data points</h3>
<ul>
<li>One hot encoding is a process that turns discrete attributes into a list of 0.0 and 1.0.</li>
<li>Minmax normalization scales continuous attributes into values between 0.0 and 1.0.</li>
</ul>
<p>You can use a codec to encode and decode a data point.</p>
<pre class="prettyprint source lang-javascript"><code>let setosa = {
    petal_length: &quot;1.5&quot;,
    petal_width: &quot;0.1&quot;,
    sepal_length: &quot;4.9&quot;,
    sepal_width: &quot;3.1&quot;,
    species: &quot;setosa&quot;
};

let versicolor = {
    petal_length: &quot;3.8&quot;,
    petal_width: &quot;1.1&quot;,
    sepal_length: &quot;5.5&quot;,
    sepal_width: &quot;2.4&quot;,
    species: &quot;versicolor&quot;
};

let virginica = {
    petal_length: &quot;6.0&quot;,
    petal_width: &quot;2.2&quot;,
    sepal_length: &quot;5.0&quot;,
    sepal_width: &quot;1.5&quot;,
    species: &quot;virginica&quot;
};

let dataset = [setosa, versicolor, virginica];

let attributes = [
    [&quot;petal_length&quot;, false],
    [&quot;petal_width&quot;, false],
    [&quot;sepal_length&quot;, false],
    [&quot;sepal_width&quot;, false],
    [&quot;species&quot;, true],
];

let codec = new syn.Codec({attributes: attributes, data: dataset});
</code></pre>
<ul>
<li>The first parameter is a list of pairs that define the name and the type (discrete or not) of each attribute.</li>
<li>The second parameter is an iterator that contains the data points.</li>
</ul>
<h3>Get the json of the codec</h3>
<pre class="prettyprint source lang-javascript"><code>let codecJson = codec.json();
// &quot;[{\&quot;Case\&quot; : \&quot;SerializableContinuous\&quot;, &quot; +
//   &quot;\&quot;Fields\&quot; : [{\&quot;key\&quot; : \&quot;petal_length\&quot;,\&quot;min\&quot; : 1.5,\&quot;max\&quot; : 6.0}]},&quot; +
//  &quot;{\&quot;Case\&quot; : \&quot;SerializableContinuous\&quot;, &quot; +
//   &quot;\&quot;Fields\&quot; : [{\&quot;key\&quot; : \&quot;petal_width\&quot;,\&quot;min\&quot; : 0.1,\&quot;max\&quot; : 2.2}]},&quot; +
//  &quot;{\&quot;Case\&quot; : \&quot;SerializableContinuous\&quot;, &quot; +
//   &quot;\&quot;Fields\&quot; : [{\&quot;key\&quot; : \&quot;sepal_length\&quot;,\&quot;min\&quot; : 4.9,\&quot;max\&quot; : 5.5}]},&quot; +
//  &quot;{\&quot;Case\&quot; : \&quot;SerializableContinuous\&quot;, &quot; +
//   &quot;\&quot;Fields\&quot; : [{\&quot;key\&quot; : \&quot;sepal_width\&quot;,\&quot;min\&quot; : 1.5,\&quot;max\&quot; : 3.1}]},&quot; +
//  &quot;{\&quot;Case\&quot; : \&quot;SerializableDiscrete\&quot;, &quot; +
//   &quot;\&quot;Fields\&quot; : [{\&quot;key\&quot; : \&quot;species\&quot;,\&quot;values\&quot; : [\&quot;virginica\&quot;,\&quot;versicolor\&quot;,\&quot;setosa\&quot;]}]}]&quot;
</code></pre>
<h3>Create a <code>Codec</code> by providing its json</h3>
<pre class="prettyprint source lang-javascript"><code>new syn.Codec({json: codecJson})
</code></pre>
<h3>Encode a data point</h3>
<pre class="prettyprint source lang-javascript"><code>let encodedSetosa = codec.encode(setosa);
// [ 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0 ]
</code></pre>
<h3>Decode a data point</h3>
<pre class="prettyprint source lang-javascript"><code>codec.decode(encodedSetosa);
// {
//     petal_length: &quot;1.5&quot;,
//     petal_width: &quot;0.1&quot;,
//     sepal_length: &quot;4.9&quot;,
//     sepal_width: &quot;3.1&quot;,
//     species: &quot;setosa&quot;
// }
</code></pre></article>
    </section>






</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Codec.html">Codec</a></li><li><a href="fun.html">fun</a></li><li><a href="Net.html">Net</a></li><li><a href="stats.html">stats</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Tue Aug 24 2021 02:39:43 GMT+0300 (Eastern European Summer Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>